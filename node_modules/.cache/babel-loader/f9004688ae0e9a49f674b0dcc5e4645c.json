{"ast":null,"code":"function initIDB(dbName, dbVersion, objectStoreNames) {\n  return new Promise((resolve, reject) => {\n    // dbName will be the DB name, storeName will be the store name.\n    if (!('indexedDB' in window)) {\n      console.warn(\"This browser doesn't support IndexedDB\");\n      return;\n    } // create or open IndexedDB\n\n\n    var request = window.indexedDB.open(dbName, dbVersion); // handle errors\n\n    request.onerror = function (event) {\n      console.error(\"IndexedDB Error: \", request.error);\n      reject(\"Failed to open database\");\n    }; // handle db upgrades\n\n\n    request.onupgradeneeded = function (event) {\n      // save the IDBDatabase interface\n      var db = event.target.result; // Create an objectStore for the database\n\n      objectStoreNames.forEach(name => {\n        var store = db.createObjectStore(name, {\n          keyPath: 'id',\n          autoIncrement: true\n        });\n\n        store.onerror = () => {\n          console.error(\"store not created, error: \", store.error);\n          reject(\"Failed to open database\");\n        };\n      });\n    };\n\n    request.onsuccess = event => {\n      resolve('success');\n    };\n  });\n}\n\nfunction getAll(dbName, dbVersion, objectStoreName) {\n  return new Promise((resolve, reject) => {\n    var request = window.indexedDB.open(dbName, dbVersion);\n\n    request.onsuccess = event => {\n      let db = request.result;\n      var transaction = db.transaction(dbName, 'readwrite');\n      let store = transaction.objectStore(objectStoreName);\n      let objStoreReq = store.getAll();\n\n      objStoreReq.onsuccess = event => {\n        resolve(event.target.result);\n      };\n\n      objStoreReq.onerror = event => {\n        reject(\"Unable to get data\");\n      };\n\n      transaction.onerror = event => {\n        reject(\"Unable to get data\");\n      };\n    };\n\n    request.onerror = event => {\n      reject(\"Unable to get data\");\n    };\n  });\n}\n\nfunction getOne(dbName, dbVersion, objectStoreName, id) {\n  return new Promise((resolve, reject) => {\n    var request = window.indexedDB.open(dbName, dbVersion);\n\n    request.onsuccess = event => {\n      let db = request.result;\n      var transaction = db.transaction(dbName, 'readwrite');\n      let store = transaction.objectStore(objectStoreName);\n      let objStoreReq = store.get(id);\n\n      objStoreReq.onsuccess = event => {\n        resolve(event.target.result);\n      };\n\n      objStoreReq.onerror = event => {\n        reject(\"Unable to get data\");\n      };\n\n      transaction.onerror = event => {\n        reject(\"Unable to get data\");\n      };\n    };\n\n    request.onerror = event => {\n      reject(\"Unable to get data\");\n    };\n  });\n}\n\nfunction addOrUpdateMany(dbName, dbVersion, objectStoreName, items) {\n  return new Promise((resolve, reject) => {\n    var request = window.indexedDB.open(dbName, dbVersion);\n\n    request.onsuccess = event => {\n      let db = request.result;\n      var transaction = db.transaction(dbName, 'readwrite');\n      var store = transaction.objectStore(objectStoreName);\n      var objStoreReq;\n      items.forEach(item => {\n        delete item.countdown;\n        objStoreReq = store.put(item);\n\n        objStoreReq.onerror = function (event) {\n          reject(\"Error storing item \" + item);\n        };\n      });\n\n      transaction.oncomplete = function (event) {\n        resolve(\"Data saved successfully\");\n      };\n\n      transaction.onerror = event => {\n        reject(\"Failed to save data\");\n      };\n    };\n\n    request.onerror = event => {\n      reject(\"Failed to save data\");\n    };\n  });\n}\n\nfunction addOrUpdateOne(dbName, dbVersion, objectStoreName, item) {\n  return new Promise((resolve, reject) => {\n    var request = window.indexedDB.open(dbName, dbVersion);\n\n    request.onsuccess = event => {\n      let db = request.result;\n      var transaction = db.transaction(dbName, 'readwrite');\n      var store = transaction.objectStore(objectStoreName);\n      store.put(item);\n\n      transaction.oncomplete = event => {\n        resolve(\"Data saved successfully\");\n      };\n\n      transaction.onerror = event => {\n        reject(\"Failed to save data\");\n      };\n    };\n\n    request.onerror = event => {\n      reject(\"Failed to save data\");\n    };\n  });\n}\n\nfunction deleteOne(dbName, dbVersion, objectStoreName, id) {\n  return new Promise((resolve, reject) => {\n    var request = window.indexedDB.open(dbName, dbVersion);\n\n    request.onsuccess = event => {\n      let db = request.result;\n      var transaction = db.transaction(dbName, 'readwrite');\n      let store = transaction.objectStore(objectStoreName);\n      let objStoreReq = store.delete(id);\n\n      objStoreReq.onsuccess = event => {\n        resolve(\"Item was deleted\");\n      };\n\n      objStoreReq.onerror = event => {\n        reject(\"Unable to delete entry\");\n      };\n\n      transaction.onerror = event => {\n        reject(\"Unable to delete entry\");\n      };\n    };\n\n    request.onerror = event => {\n      reject(\"Unable to delete entry\");\n    };\n  });\n}\n\nfunction deleteAll(dbName, dbVersion, objectStoreNames) {\n  return new Promise((resolve, reject) => {\n    var request = window.indexedDB.open(dbName, dbVersion);\n\n    request.onsuccess = event => {\n      let db = request.result;\n      var transaction = db.transaction(dbName, 'readwrite');\n      objectStoreNames.forEach(name => {\n        let store = transaction.objectStore(name);\n        let objStoreReq = store.clear();\n\n        objStoreReq.onsuccess = event => {\n          let message = \"Data has been successfully deleted\";\n          resolve(message);\n        };\n\n        objStoreReq.onerror = event => {\n          reject(\"Unable to delete data\");\n        };\n      });\n\n      transaction.onerror = event => {\n        reject(\"Unable to delete data\");\n      };\n    };\n\n    request.onerror = event => {\n      reject(\"Unable to delete data\");\n    };\n  });\n}\n\nexport let iDB = {\n  init: initIDB,\n  getAll: getAll,\n  getOne: getOne,\n  addOrUpdateMany: addOrUpdateMany,\n  addOrUpdateOne: addOrUpdateOne,\n  deleteOne: deleteOne,\n  deleteAll: deleteAll\n};","map":{"version":3,"sources":["C:/Users/ceg94/Development/10for20challenge/src/data/indexedDb.ts"],"names":["initIDB","dbName","dbVersion","objectStoreNames","Promise","resolve","reject","window","console","warn","request","indexedDB","open","onerror","event","error","onupgradeneeded","db","target","result","forEach","name","store","createObjectStore","keyPath","autoIncrement","onsuccess","getAll","objectStoreName","transaction","objectStore","objStoreReq","getOne","id","get","addOrUpdateMany","items","item","countdown","put","oncomplete","addOrUpdateOne","deleteOne","delete","deleteAll","clear","message","iDB","init"],"mappings":"AACA,SAASA,OAAT,CAAiBC,MAAjB,EAAgCC,SAAhC,EAAkDC,gBAAlD,EAA4E;AAC1E,SAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAASC,MAAT,KAAmB;AACpC;AACA,QAAG,EAAE,eAAeC,MAAjB,CAAH,EAA4B;AAC1BC,MAAAA,OAAO,CAACC,IAAR,CAAa,wCAAb;AACA;AACD,KALmC,CAMpC;;;AACA,QAAIC,OAAO,GAAGH,MAAM,CAACI,SAAP,CAAiBC,IAAjB,CAAsBX,MAAtB,EAA8BC,SAA9B,CAAd,CAPoC,CASpC;;AACAQ,IAAAA,OAAO,CAACG,OAAR,GAAkB,UAASC,KAAT,EAAmB;AACnCN,MAAAA,OAAO,CAACO,KAAR,CAAc,mBAAd,EAAmCL,OAAO,CAACK,KAA3C;AACAT,MAAAA,MAAM,CAAC,yBAAD,CAAN;AACD,KAHD,CAVoC,CAepC;;;AACAI,IAAAA,OAAO,CAACM,eAAR,GAA0B,UAASF,KAAT,EAAoB;AAC5C;AACA,UAAIG,EAAE,GAAGH,KAAK,CAACI,MAAN,CAAaC,MAAtB,CAF4C,CAG5C;;AACAhB,MAAAA,gBAAgB,CAACiB,OAAjB,CAA0BC,IAAD,IAAQ;AAC/B,YAAIC,KAAK,GAAGL,EAAE,CAACM,iBAAH,CACVF,IADU,EAEV;AAACG,UAAAA,OAAO,EAAC,IAAT;AAAcC,UAAAA,aAAa,EAAC;AAA5B,SAFU,CAAZ;;AAKAH,QAAAA,KAAK,CAACT,OAAN,GAAgB,MAAM;AACpBL,UAAAA,OAAO,CAACO,KAAR,CAAc,4BAAd,EAA2CO,KAAK,CAACP,KAAjD;AACAT,UAAAA,MAAM,CAAC,yBAAD,CAAN;AACD,SAHD;AAID,OAVD;AAWD,KAfD;;AAiBAI,IAAAA,OAAO,CAACgB,SAAR,GAAqBZ,KAAD,IAAe;AACjCT,MAAAA,OAAO,CAAC,SAAD,CAAP;AACD,KAFD;AAGD,GApCM,CAAP;AAqCD;;AAED,SAASsB,MAAT,CAAgB1B,MAAhB,EAA+BC,SAA/B,EAAiD0B,eAAjD,EAAwE;AACtE,SAAO,IAAIxB,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAmB;AACpC,QAAII,OAAO,GAAGH,MAAM,CAACI,SAAP,CAAiBC,IAAjB,CAAsBX,MAAtB,EAA8BC,SAA9B,CAAd;;AAEAQ,IAAAA,OAAO,CAACgB,SAAR,GAAqBZ,KAAD,IAAe;AACjC,UAAIG,EAAE,GAAGP,OAAO,CAACS,MAAjB;AACA,UAAIU,WAAW,GAAGZ,EAAE,CAACY,WAAH,CAAe5B,MAAf,EAAuB,WAAvB,CAAlB;AAEA,UAAIqB,KAAK,GAAGO,WAAW,CAACC,WAAZ,CAAwBF,eAAxB,CAAZ;AACA,UAAIG,WAAW,GAAGT,KAAK,CAACK,MAAN,EAAlB;;AAEAI,MAAAA,WAAW,CAACL,SAAZ,GAAyBZ,KAAD,IAAe;AACrCT,QAAAA,OAAO,CAACS,KAAK,CAACI,MAAN,CAAaC,MAAd,CAAP;AACD,OAFD;;AAIAY,MAAAA,WAAW,CAAClB,OAAZ,GAAuBC,KAAD,IAAe;AACnCR,QAAAA,MAAM,CAAC,oBAAD,CAAN;AACD,OAFD;;AAIAuB,MAAAA,WAAW,CAAChB,OAAZ,GAAuBC,KAAD,IAAe;AACnCR,QAAAA,MAAM,CAAC,oBAAD,CAAN;AACD,OAFD;AAGD,KAlBD;;AAoBAI,IAAAA,OAAO,CAACG,OAAR,GAAmBC,KAAD,IAAe;AAC/BR,MAAAA,MAAM,CAAC,oBAAD,CAAN;AACD,KAFD;AAGD,GA1BM,CAAP;AA2BD;;AAED,SAAS0B,MAAT,CAAgB/B,MAAhB,EAA+BC,SAA/B,EAAiD0B,eAAjD,EAAyEK,EAAzE,EAAgF;AAC9E,SAAO,IAAI7B,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAmB;AACpC,QAAII,OAAO,GAAGH,MAAM,CAACI,SAAP,CAAiBC,IAAjB,CAAsBX,MAAtB,EAA8BC,SAA9B,CAAd;;AAEAQ,IAAAA,OAAO,CAACgB,SAAR,GAAqBZ,KAAD,IAAe;AACjC,UAAIG,EAAE,GAAGP,OAAO,CAACS,MAAjB;AACA,UAAIU,WAAW,GAAGZ,EAAE,CAACY,WAAH,CAAe5B,MAAf,EAAuB,WAAvB,CAAlB;AAEA,UAAIqB,KAAK,GAAGO,WAAW,CAACC,WAAZ,CAAwBF,eAAxB,CAAZ;AACA,UAAIG,WAAW,GAAGT,KAAK,CAACY,GAAN,CAAUD,EAAV,CAAlB;;AAEAF,MAAAA,WAAW,CAACL,SAAZ,GAAyBZ,KAAD,IAAe;AACrCT,QAAAA,OAAO,CAACS,KAAK,CAACI,MAAN,CAAaC,MAAd,CAAP;AACD,OAFD;;AAIAY,MAAAA,WAAW,CAAClB,OAAZ,GAAuBC,KAAD,IAAe;AACnCR,QAAAA,MAAM,CAAC,oBAAD,CAAN;AACD,OAFD;;AAIAuB,MAAAA,WAAW,CAAChB,OAAZ,GAAuBC,KAAD,IAAe;AACnCR,QAAAA,MAAM,CAAC,oBAAD,CAAN;AACD,OAFD;AAGD,KAlBD;;AAoBAI,IAAAA,OAAO,CAACG,OAAR,GAAmBC,KAAD,IAAe;AAC/BR,MAAAA,MAAM,CAAC,oBAAD,CAAN;AACD,KAFD;AAGD,GA1BM,CAAP;AA2BD;;AAED,SAAS6B,eAAT,CAAyBlC,MAAzB,EAAwCC,SAAxC,EAA0D0B,eAA1D,EAAkFQ,KAAlF,EAA+F;AAC7F,SAAO,IAAIhC,OAAJ,CAAY,CAACC,OAAD,EAASC,MAAT,KAAoB;AACrC,QAAII,OAAO,GAAGH,MAAM,CAACI,SAAP,CAAiBC,IAAjB,CAAsBX,MAAtB,EAA8BC,SAA9B,CAAd;;AAEAQ,IAAAA,OAAO,CAACgB,SAAR,GAAqBZ,KAAD,IAAe;AACjC,UAAIG,EAAE,GAAGP,OAAO,CAACS,MAAjB;AACA,UAAIU,WAAW,GAAGZ,EAAE,CAACY,WAAH,CAAe5B,MAAf,EAAuB,WAAvB,CAAlB;AACA,UAAIqB,KAAK,GAAGO,WAAW,CAACC,WAAZ,CAAwBF,eAAxB,CAAZ;AACA,UAAIG,WAAJ;AACAK,MAAAA,KAAK,CAAChB,OAAN,CAAeiB,IAAD,IAAc;AAC1B,eAAOA,IAAI,CAACC,SAAZ;AACAP,QAAAA,WAAW,GAAGT,KAAK,CAACiB,GAAN,CAAUF,IAAV,CAAd;;AAEAN,QAAAA,WAAW,CAAClB,OAAZ,GAAsB,UAASC,KAAT,EAAgB;AACpCR,UAAAA,MAAM,CAAC,wBAAsB+B,IAAvB,CAAN;AACD,SAFD;AAGD,OAPD;;AASAR,MAAAA,WAAW,CAACW,UAAZ,GAAyB,UAAS1B,KAAT,EAAgB;AACvCT,QAAAA,OAAO,CAAC,yBAAD,CAAP;AACD,OAFD;;AAIAwB,MAAAA,WAAW,CAAChB,OAAZ,GAAuBC,KAAD,IAAe;AACnCR,QAAAA,MAAM,CAAC,qBAAD,CAAN;AACD,OAFD;AAGD,KArBD;;AAuBAI,IAAAA,OAAO,CAACG,OAAR,GAAmBC,KAAD,IAAe;AAC/BR,MAAAA,MAAM,CAAC,qBAAD,CAAN;AACD,KAFD;AAGD,GA7BM,CAAP;AA8BD;;AAED,SAASmC,cAAT,CAAwBxC,MAAxB,EAAuCC,SAAvC,EAAyD0B,eAAzD,EAAiFS,IAAjF,EAA0F;AACxF,SAAO,IAAIjC,OAAJ,CAAY,CAACC,OAAD,EAASC,MAAT,KAAoB;AACrC,QAAII,OAAO,GAAGH,MAAM,CAACI,SAAP,CAAiBC,IAAjB,CAAsBX,MAAtB,EAA8BC,SAA9B,CAAd;;AAEAQ,IAAAA,OAAO,CAACgB,SAAR,GAAqBZ,KAAD,IAAe;AACjC,UAAIG,EAAE,GAAGP,OAAO,CAACS,MAAjB;AACA,UAAIU,WAAW,GAAGZ,EAAE,CAACY,WAAH,CAAe5B,MAAf,EAAuB,WAAvB,CAAlB;AACA,UAAIqB,KAAK,GAAGO,WAAW,CAACC,WAAZ,CAAwBF,eAAxB,CAAZ;AACAN,MAAAA,KAAK,CAACiB,GAAN,CAAUF,IAAV;;AAEAR,MAAAA,WAAW,CAACW,UAAZ,GAA0B1B,KAAD,IAAe;AACtCT,QAAAA,OAAO,CAAC,yBAAD,CAAP;AACD,OAFD;;AAIAwB,MAAAA,WAAW,CAAChB,OAAZ,GAAuBC,KAAD,IAAe;AACnCR,QAAAA,MAAM,CAAC,qBAAD,CAAN;AACD,OAFD;AAGD,KAbD;;AAeAI,IAAAA,OAAO,CAACG,OAAR,GAAmBC,KAAD,IAAe;AAC/BR,MAAAA,MAAM,CAAC,qBAAD,CAAN;AACD,KAFD;AAGD,GArBM,CAAP;AAsBD;;AAED,SAASoC,SAAT,CAAmBzC,MAAnB,EAAkCC,SAAlC,EAAoD0B,eAApD,EAA4EK,EAA5E,EAAmF;AACjF,SAAO,IAAI7B,OAAJ,CAAY,CAACC,OAAD,EAASC,MAAT,KAAkB;AACnC,QAAII,OAAO,GAAGH,MAAM,CAACI,SAAP,CAAiBC,IAAjB,CAAsBX,MAAtB,EAA8BC,SAA9B,CAAd;;AAEAQ,IAAAA,OAAO,CAACgB,SAAR,GAAqBZ,KAAD,IAAe;AACjC,UAAIG,EAAE,GAAGP,OAAO,CAACS,MAAjB;AACA,UAAIU,WAAW,GAAGZ,EAAE,CAACY,WAAH,CAAe5B,MAAf,EAAuB,WAAvB,CAAlB;AACA,UAAIqB,KAAK,GAAGO,WAAW,CAACC,WAAZ,CAAwBF,eAAxB,CAAZ;AACA,UAAIG,WAAW,GAAGT,KAAK,CAACqB,MAAN,CAAaV,EAAb,CAAlB;;AAEAF,MAAAA,WAAW,CAACL,SAAZ,GAAyBZ,KAAD,IAAe;AACrCT,QAAAA,OAAO,CAAC,kBAAD,CAAP;AACD,OAFD;;AAIA0B,MAAAA,WAAW,CAAClB,OAAZ,GAAuBC,KAAD,IAAe;AACnCR,QAAAA,MAAM,CAAC,wBAAD,CAAN;AACD,OAFD;;AAIAuB,MAAAA,WAAW,CAAChB,OAAZ,GAAuBC,KAAD,IAAe;AACnCR,QAAAA,MAAM,CAAC,wBAAD,CAAN;AACD,OAFD;AAGD,KAjBD;;AAmBAI,IAAAA,OAAO,CAACG,OAAR,GAAmBC,KAAD,IAAe;AAC/BR,MAAAA,MAAM,CAAC,wBAAD,CAAN;AACD,KAFD;AAGD,GAzBM,CAAP;AA0BD;;AAED,SAASsC,SAAT,CAAmB3C,MAAnB,EAAkCC,SAAlC,EAAoDC,gBAApD,EAA8E;AAC5E,SAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAASC,MAAT,KAAkB;AACnC,QAAII,OAAO,GAAGH,MAAM,CAACI,SAAP,CAAiBC,IAAjB,CAAsBX,MAAtB,EAA8BC,SAA9B,CAAd;;AAEAQ,IAAAA,OAAO,CAACgB,SAAR,GAAqBZ,KAAD,IAAe;AACjC,UAAIG,EAAE,GAAGP,OAAO,CAACS,MAAjB;AACA,UAAIU,WAAW,GAAGZ,EAAE,CAACY,WAAH,CAAe5B,MAAf,EAAuB,WAAvB,CAAlB;AAEAE,MAAAA,gBAAgB,CAACiB,OAAjB,CAA0BC,IAAD,IAAQ;AAC/B,YAAIC,KAAK,GAAGO,WAAW,CAACC,WAAZ,CAAwBT,IAAxB,CAAZ;AACA,YAAIU,WAAW,GAAGT,KAAK,CAACuB,KAAN,EAAlB;;AAEAd,QAAAA,WAAW,CAACL,SAAZ,GAAyBZ,KAAD,IAAe;AACrC,cAAIgC,OAAO,GAAG,oCAAd;AACAzC,UAAAA,OAAO,CAACyC,OAAD,CAAP;AACD,SAHD;;AAKAf,QAAAA,WAAW,CAAClB,OAAZ,GAAuBC,KAAD,IAAe;AACnCR,UAAAA,MAAM,CAAC,uBAAD,CAAN;AACD,SAFD;AAGD,OAZD;;AAcAuB,MAAAA,WAAW,CAAChB,OAAZ,GAAuBC,KAAD,IAAe;AACnCR,QAAAA,MAAM,CAAC,uBAAD,CAAN;AACD,OAFD;AAGD,KArBD;;AAuBAI,IAAAA,OAAO,CAACG,OAAR,GAAmBC,KAAD,IAAe;AAC/BR,MAAAA,MAAM,CAAC,uBAAD,CAAN;AACD,KAFD;AAGD,GA7BM,CAAP;AA8BD;;AAED,OAAO,IAAIyC,GAAG,GAAG;AACfC,EAAAA,IAAI,EAAEhD,OADS;AAEf2B,EAAAA,MAAM,EAAEA,MAFO;AAGfK,EAAAA,MAAM,EAAEA,MAHO;AAIfG,EAAAA,eAAe,EAAEA,eAJF;AAKfM,EAAAA,cAAc,EAAEA,cALD;AAMfC,EAAAA,SAAS,EAAEA,SANI;AAOfE,EAAAA,SAAS,EAAEA;AAPI,CAAV","sourcesContent":["\r\nfunction initIDB(dbName:string, dbVersion:number, objectStoreNames:string[]){\r\n  return new Promise((resolve,reject)=> {\r\n    // dbName will be the DB name, storeName will be the store name.\r\n    if(!('indexedDB' in window)){\r\n      console.warn(\"This browser doesn't support IndexedDB\");\r\n      return;\r\n    }\r\n    // create or open IndexedDB\r\n    var request = window.indexedDB.open(dbName, dbVersion);\r\n\r\n    // handle errors\r\n    request.onerror = function(event:any){\r\n      console.error(\"IndexedDB Error: \", request.error);\r\n      reject(\"Failed to open database\");\r\n    };\r\n\r\n    // handle db upgrades\r\n    request.onupgradeneeded = function(event:any) {\r\n      // save the IDBDatabase interface\r\n      var db = event.target.result;\r\n      // Create an objectStore for the database\r\n      objectStoreNames.forEach((name)=>{\r\n        var store = db.createObjectStore(\r\n          name,\r\n          {keyPath:'id',autoIncrement:true}\r\n        );\r\n\r\n        store.onerror = () => {\r\n          console.error(\"store not created, error: \",store.error);\r\n          reject(\"Failed to open database\");\r\n        };\r\n      });\r\n    };\r\n\r\n    request.onsuccess = (event:any) => {\r\n      resolve('success');\r\n    };\r\n  });\r\n}\r\n\r\nfunction getAll(dbName:string, dbVersion:number, objectStoreName:string){\r\n  return new Promise((resolve, reject)=>{\r\n    var request = window.indexedDB.open(dbName, dbVersion);\r\n\r\n    request.onsuccess = (event:any) => {\r\n      let db = request.result;\r\n      var transaction = db.transaction(dbName, 'readwrite');\r\n\r\n      let store = transaction.objectStore(objectStoreName);\r\n      let objStoreReq = store.getAll();\r\n\r\n      objStoreReq.onsuccess = (event:any) => {\r\n        resolve(event.target.result);\r\n      };\r\n\r\n      objStoreReq.onerror = (event:any) => {\r\n        reject(\"Unable to get data\");\r\n      };\r\n\r\n      transaction.onerror = (event:any) => {\r\n        reject(\"Unable to get data\");\r\n      };\r\n    };\r\n\r\n    request.onerror = (event:any) => {\r\n      reject(\"Unable to get data\");\r\n    };\r\n  });\r\n}\r\n\r\nfunction getOne(dbName:string, dbVersion:number, objectStoreName:string, id:any){\r\n  return new Promise((resolve, reject)=>{\r\n    var request = window.indexedDB.open(dbName, dbVersion);\r\n\r\n    request.onsuccess = (event:any) => {\r\n      let db = request.result;\r\n      var transaction = db.transaction(dbName, 'readwrite');\r\n\r\n      let store = transaction.objectStore(objectStoreName);\r\n      let objStoreReq = store.get(id);\r\n\r\n      objStoreReq.onsuccess = (event:any) => {\r\n        resolve(event.target.result);\r\n      };\r\n\r\n      objStoreReq.onerror = (event:any) => {\r\n        reject(\"Unable to get data\");\r\n      };\r\n\r\n      transaction.onerror = (event:any) => {\r\n        reject(\"Unable to get data\");\r\n      };\r\n    };\r\n\r\n    request.onerror = (event:any) => {\r\n      reject(\"Unable to get data\");\r\n    };\r\n  });\r\n}\r\n\r\nfunction addOrUpdateMany(dbName:string, dbVersion:number, objectStoreName:string, items:any[]) {\r\n  return new Promise((resolve,reject) => {\r\n    var request = window.indexedDB.open(dbName, dbVersion);\r\n\r\n    request.onsuccess = (event:any) => {\r\n      let db = request.result;\r\n      var transaction = db.transaction(dbName, 'readwrite');\r\n      var store = transaction.objectStore(objectStoreName);\r\n      var objStoreReq;\r\n      items.forEach((item:any) => {\r\n        delete item.countdown;\r\n        objStoreReq = store.put(item);\r\n        \r\n        objStoreReq.onerror = function(event) {\r\n          reject(\"Error storing item \"+item);\r\n        };\r\n      });\r\n\r\n      transaction.oncomplete = function(event) {\r\n        resolve(\"Data saved successfully\");\r\n      };\r\n\r\n      transaction.onerror = (event:any) => {\r\n        reject(\"Failed to save data\");\r\n      };\r\n    };\r\n\r\n    request.onerror = (event:any) => {\r\n      reject(\"Failed to save data\");\r\n    };\r\n  });\r\n}\r\n\r\nfunction addOrUpdateOne(dbName:string, dbVersion:number, objectStoreName:string, item:any){\r\n  return new Promise((resolve,reject) => {\r\n    var request = window.indexedDB.open(dbName, dbVersion);\r\n\r\n    request.onsuccess = (event:any) => {\r\n      let db = request.result;\r\n      var transaction = db.transaction(dbName, 'readwrite');\r\n      var store = transaction.objectStore(objectStoreName);\r\n      store.put(item);\r\n\r\n      transaction.oncomplete = (event:any) => {\r\n        resolve(\"Data saved successfully\");\r\n      };\r\n\r\n      transaction.onerror = (event:any) => {\r\n        reject(\"Failed to save data\");\r\n      };\r\n    };\r\n\r\n    request.onerror = (event:any) => {\r\n      reject(\"Failed to save data\");\r\n    };\r\n  });\r\n}\r\n\r\nfunction deleteOne(dbName:string, dbVersion:number, objectStoreName:string, id:any){\r\n  return new Promise((resolve,reject)=>{\r\n    var request = window.indexedDB.open(dbName, dbVersion);\r\n\r\n    request.onsuccess = (event:any) => {\r\n      let db = request.result;\r\n      var transaction = db.transaction(dbName, 'readwrite');\r\n      let store = transaction.objectStore(objectStoreName);\r\n      let objStoreReq = store.delete(id);\r\n\r\n      objStoreReq.onsuccess = (event:any) => {\r\n        resolve(\"Item was deleted\");\r\n      };\r\n\r\n      objStoreReq.onerror = (event:any) => {\r\n        reject(\"Unable to delete entry\");\r\n      };\r\n\r\n      transaction.onerror = (event:any) => {\r\n        reject(\"Unable to delete entry\");\r\n      };\r\n    };\r\n\r\n    request.onerror = (event:any) => {\r\n      reject(\"Unable to delete entry\");\r\n    };\r\n  });\r\n}\r\n\r\nfunction deleteAll(dbName:string, dbVersion:number, objectStoreNames:string[]){\r\n  return new Promise((resolve,reject)=>{\r\n    var request = window.indexedDB.open(dbName, dbVersion);\r\n\r\n    request.onsuccess = (event:any) => {\r\n      let db = request.result;\r\n      var transaction = db.transaction(dbName, 'readwrite');\r\n\r\n      objectStoreNames.forEach((name)=>{\r\n        let store = transaction.objectStore(name);\r\n        let objStoreReq = store.clear();\r\n  \r\n        objStoreReq.onsuccess = (event:any) => {\r\n          let message = \"Data has been successfully deleted\";\r\n          resolve(message);\r\n        };\r\n  \r\n        objStoreReq.onerror = (event:any) => {\r\n          reject(\"Unable to delete data\");\r\n        };\r\n      })\r\n\r\n      transaction.onerror = (event:any) => {\r\n        reject(\"Unable to delete data\");\r\n      };\r\n    };\r\n\r\n    request.onerror = (event:any) => {\r\n      reject(\"Unable to delete data\");\r\n    };\r\n  });\r\n}\r\n\r\nexport let iDB = {\r\n  init: initIDB,\r\n  getAll: getAll,\r\n  getOne: getOne,\r\n  addOrUpdateMany: addOrUpdateMany, \r\n  addOrUpdateOne: addOrUpdateOne, \r\n  deleteOne: deleteOne, \r\n  deleteAll: deleteAll\r\n};"]},"metadata":{},"sourceType":"module"}